#include <stdio.h> // อนุญาตให้ใช้สำหรับฟังก์ชัน printf ใน main() เพื่อทดสอบ

// ฟังก์ชัน ft_sort_int_tab ที่ถูกต้องแล้ว
// ใช้ Bubble Sort เพื่อเรียงลำดับอาร์เรย์ของจำนวนเต็มจากน้อยไปมาก
// โดยไม่ใช้ break และใช้ตัวแปร 'swap' เพื่อปรับปรุงประสิทธิภาพ
void ft_sort_int_tab(int *tab, int size)
{
    int i; // ตัวแปรสำหรับลูปภายนอก (ควบคุมจำนวนรอบการตรวจสอบ)
    int j; // ตัวแปรสำหรับลูปภายใน (เปรียบเทียบและสลับคู่ที่อยู่ติดกัน)
    int swap; // ใช้เป็น flag (0 = false, 1 = true) เพื่อตรวจสอบว่ามีการสลับเกิดขึ้นในรอบนั้นหรือไม่
    int temp; // ตัวแปรชั่วคราวสำหรับเก็บค่าในการสลับ

    i = 0;
    swap = 1; // ตั้งค่าเริ่มต้นเป็น 1 เพื่อให้ลูปภายนอกเริ่มทำงาน

    // ลูปภายนอก: จะทำงานตราบใดที่ 'swap' เป็น 1 (มีการสลับเกิดขึ้นในรอบก่อนหน้า)
    // และ 'i' ยังไม่ถึง size - 1 (ยังไม่ครบจำนวนรอบที่จำเป็นต้องตรวจสอบ)
    while (swap == 1 && i < size - 1)
    {
        swap = 0; // รีเซ็ต 'swap' เป็น 0 ก่อนเริ่มรอบการเปรียบเทียบภายใน
                  // หากไม่มีการสลับใดๆ ในรอบนี้ 'swap' จะยังคงเป็น 0 และลูปภายนอกจะหยุดทำงาน

        j = 0;
        // ลูปภายใน: เปรียบเทียบและสลับคู่ที่อยู่ติดกัน
        // j < size - 1 - i: ขอบเขตของ j จะลดลงในแต่ละรอบของ i
        // เพราะ i องค์ประกอบสุดท้ายของอาร์เรย์ถูกจัดเรียงแล้ว
        while (j < size - 1 - i)
        {
            // เปรียบเทียบ tab[j] กับ tab[j + 1]
            if (tab[j] > tab[j + 1])
            {
                // ทำการสลับค่าของ tab[j] และ tab[j + 1]
                temp = tab[j];
                tab[j] = tab[j + 1];
                tab[j + 1] = temp;

                swap = 1; // ตั้งค่า 'swap' เป็น 1 เพื่อระบุว่ามีการสลับเกิดขึ้นในรอบนี้
            }
            j++; // เพิ่มค่า j เพื่อเลื่อนไปยังคู่ถัดไป
        }
        i++; // เพิ่มค่า i เพื่อลดขอบเขตการทำงานของลูปภายในในรอบถัดไป
    }
}

// ฟังก์ชัน main() สำหรับทดสอบการทำงาน
int main(void)
{
    // ตัวอย่างอาร์เรย์ที่ต้องการเรียงลำดับ
    // ลองเปลี่ยนค่าในอาร์เรย์นี้เพื่อทดสอบกรณีอื่นๆ ได้
    int arr[] = {5, 1, 4, 2, 8}; // ตัวอย่างจาก Demo
    // int arr[] = {10, 9, 8, 7, 6, 5}; // ตัวอย่างเรียงจากมากไปน้อย
    // int arr[] = {1, 2, 3, 4, 5}; // ตัวอย่างที่เรียงแล้ว
    int size = sizeof(arr) / sizeof(arr[0]); // คำนวณขนาดของอาร์เรย์

    printf("Array before sorting: ");
    for (int k = 0; k < size; k++) // ใช้ k เป็นตัวแปรลูปเพื่อไม่ให้สับสนกับ i ใน ft_sort_int_tab
    {
        printf("%d ", arr[k]);
    }
    printf("\n");

    // เรียกใช้ฟังก์ชัน ft_sort_int_tab เพื่อเรียงลำดับอาร์เรย์
    ft_sort_int_tab(arr, size);

    printf("Array after sorting: ");
    // ลูปสำหรับแสดงผลอาร์เรย์ที่เรียงลำดับแล้ว
    // แก้ไข: เงื่อนไขลูปเป็น i < size และลบ i++ ภายในลูป
    for (int i = 0; i < size; i++) // เงื่อนไขถูกต้อง: i น้อยกว่าขนาดอาร์เรย์
    {
        printf("%d ", arr[i]); // พิมพ์ค่าขององค์ประกอบ
        // ลบ i++; ที่ซ้ำซ้อนออกไป
    }
    printf("\n");
    
    return 0; // คืนค่า 0 เพื่อระบุว่าโปรแกรมทำงานเสร็จสมบูรณ์
}
